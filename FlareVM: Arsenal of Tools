ğŸ”¬ TryHackMe â€“ FlareVM Notes
ğŸ“Œ Introduction

FlareVM (Forensics, Logic Analysis, and Reverse Engineering) to specjalistyczna maszyna wirtualna zawierajÄ…ca zestaw narzÄ™dzi dla:

Reverse Engineers

Malware Analysts

Incident Responders

Forensic Investigators

Penetration Testers

ZostaÅ‚a stworzona przez FLARE Team (FireEye) jako Å›rodowisko â€all-in-oneâ€ do analizy malware i Å›ledztw cyfrowych.

ğŸ§°Categories of Tools in FlareVM
1ï¸âƒ£ Reverse Engineering & Debugging

Reverse engineering = rozkÅ‚adanie gotowego programu, aby zrozumieÄ‡ jak dziaÅ‚a.
Debugging = analiza bÅ‚Ä™dÃ³w i zachowania programu w trakcie dziaÅ‚ania.

Tool	Description
Ghidra	Open-source reverse engineering suite
x64dbg	Debugger dla x64 i x32
OllyDbg	Debugger assembly-level
Radare2	Zaawansowana platforma RE
Binary Ninja	Disassembler & decompiler
PEiD	Wykrywanie packerÃ³w i kompilatorÃ³w
2ï¸âƒ£ Disassemblers & Decompilers

UmoÅ¼liwiajÄ… analizÄ™ malware poprzez rozbijanie pliku wykonywalnego na czytelnÄ… formÄ™.

Tool	Purpose
CFF Explorer	Edytor plikÃ³w PE
Hopper	Debugger + Disassembler + Decompiler
RetDec	Open-source decompiler
3ï¸âƒ£ Static & Dynamic Analysis

Static Analysis â†’ analiza bez uruchamiania pliku

Dynamic Analysis â†’ obserwacja zachowania podczas dziaÅ‚ania

Tool	Purpose
Process Hacker	Monitor procesÃ³w
PEview	Viewer PE
Dependency Walker	Analiza DLL dependencies
DIE	Detect It Easy (packer detection)
4ï¸âƒ£ Forensics & Incident Response
Tool	Purpose
Volatility	Analiza RAM dump
Rekall	Memory forensics
FTK Imager	Tworzenie obrazÃ³w dysku
5ï¸âƒ£ Network Analysis
Tool	Purpose
Wireshark	Analiza ruchu sieciowego
Nmap	Skanowanie sieci
Netcat	Praca z poÅ‚Ä…czeniami TCP/UDP
6ï¸âƒ£ File Analysis
Tool	Purpose
FileInsight	Edycja plikÃ³w binarnych
Hex Fiend	Hex editor
HxD	Hex editor (Windows)
7ï¸âƒ£ Scripting & Automation
Tool	Purpose
Python	Automatyzacja
PowerShell Empire	Post-exploitation framework
8ï¸âƒ£ Sysinternals Suite
Tool	Purpose
Autoruns	Co uruchamia siÄ™ przy starcie
Process Explorer	Zaawansowany menedÅ¼er procesÃ³w
Process Monitor	Monitorowanie aktywnoÅ›ci systemu
ğŸ” Core Investigation Tools (Used in This Room)
Tool	Investigative Value
Procmon	Monitor system activity
Process Explorer	Parent-child process analysis
HxD	Hex analysis
Wireshark	Network traffic inspection
CFF Explorer	Hash generation & PE info
PEStudio	Static executable analysis
FLOSS	Extract & deobfuscate strings
ğŸ›  Tool Deep Dive
ğŸ”¹ Process Monitor (Procmon)

Monitoruje w czasie rzeczywistym:

File system activity

Registry activity

Process/Thread activity

ğŸ” Example: LSASS Monitoring

lsass.exe = Local Security Authority Subsystem Service
Odpowiada za uwierzytelnianie.

âš  JeÅ›li widzimy:

Nietypowe procesy czytajÄ…ce pamiÄ™Ä‡ LSASS

DostÄ™p do LSASS przez nieznane procesy

MoÅ¼e to oznaczaÄ‡ credential dumping (np. Mimikatz).

ğŸ”¹ Process Explorer

Zaawansowana analiza procesÃ³w:

Parent-child relationships

Loaded DLLs

Path do pliku

User context

Przydatne do wykrywania:

Makr Word uruchamiajÄ…cych PowerShell

LNK files spawnujÄ…cych cmd

ISO / malicious droppers

ğŸ”¹ HxD (Hex Editor)

Pozwala analizowaÄ‡ pliki binarne w hex.

ğŸ” Example

Plik zaczyna siÄ™ od:

4D 5A


To oznacza nagÅ‚Ã³wek MZ â†’ plik wykonywalny PE.

MoÅ¼emy:

SprawdziÄ‡ strukturÄ™

SzukaÄ‡ ukrytych danych

WykryÄ‡ manipulacje

ğŸ”¹ CFF Explorer

Analiza plikÃ³w PE:

MD5

SHA-1

Timestamp

Architecture (x86/x64)

PrzykÅ‚ad:

64-bit PE

Generated: 23 September 2024

Hash verification (VirusTotal lookup)

ğŸ”¹ Wireshark

Analiza ruchu sieciowego:

Source IP

Destination IP

Port

Protocol

W przykÅ‚adzie:

TLSv1.2

TCP

Encrypted traffic

âš  Malware czÄ™sto uÅ¼ywa TLS do ukrycia C2 communication.

ğŸ”¹ PEStudio (Static Analysis)

Analiza bez uruchamiania pliku.

Sprawdza:

Entropy (czy plik jest spakowany)

Imports

Strings

Metadata

Indicators

Example: PsExec

Entropy: 6.596

Wysoka entropia â†’ moÅ¼liwe:

Packing

Encryption

Obfuscation

PsExec = dual-use tool:

Legit (admin)

Abuse (lateral movement)

ğŸ”¹ FLOSS

FLARE Obfuscated String Solver

Extracts:

Static strings

Stack strings

Tight strings

Decoded strings

Example output:

189 static strings extracted

No decoded strings detected

MoÅ¼e ujawniÄ‡:

C2 URLs

IP addresses

Registry keys

Encryption keys

ğŸ§ª Practical Investigation â€“ windows.exe
ğŸ•µ Scenario

User downloaded:

windows.exe
Date: 09/24/2024 03:43 AM
Location: C:\Users\Administrator\Desktop\Sample


Flagged as suspicious.

ğŸ” Step 1 â€“ Static Analysis (PEStudio)
Hashes:

MD5: 9FDD4767DE5AEC8E577C1916ECC3E1D6

SHA-1: A1BC55A7931BFCD24651357829C460FD3DC4828F

â†’ Should be checked on VirusTotal.

ğŸš© Red Flags

Claims to be:

Windows Registry Editor (REGEDIT)

Location:

User directory


âŒ Legit REGEDIT znajduje siÄ™ w:

C:\Windows\System32


Russian metadata:

"Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€ Ñ€ĞµĞµÑÑ‚Ñ€Ğ°"


JeÅ›li organizacja nie dziaÅ‚a w rosyjskim Å›rodowisku â†’ suspicious.

No Rich Header
â†’ moÅ¼liwe:

Packing

Obfuscation

Anti-analysis techniques

ğŸ¯ Learning Objectives

Zrozumienie Å›rodowiska FlareVM

Static vs Dynamic Analysis

Analiza procesÃ³w Windows

Identyfikacja podejrzanych executable

Extracting hidden strings

âš ï¸ Important Disclaimer

FlareVM zawiera prawdziwe prÃ³bki malware.

NIGDY:

Nie pobieraj ich poza VM

Nie uruchamiaj na host systemie

Nie udostÄ™pniaj plikÃ³w

Analiza tylko w:

Isolated

Controlled

Offline environment

ğŸ§  Key Takeaways

âœ” FlareVM = kompletne Å›rodowisko malware analysis
âœ” Static analysis = pierwszy krok
âœ” Entropy + metadata = duÅ¼e red flagi
âœ” LSASS monitoring = credential theft detection
âœ” Parent-child process relationships = kluczowe
âœ” TLS traffic â‰  safe traffic
